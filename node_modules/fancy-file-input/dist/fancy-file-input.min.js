/*! jQuery Fancy File Input plugin - v2.0.4 - 2018-11-23
* Copyright (c) 2018 Atlassian Pty Ltd; Licensed Apache-2.0 */

!function(e,i){void 0===e&&void 0!==window&&(e=window),"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.FancyFileInput=i(t)}):"object"==typeof module&&module.exports?module.exports=i(require("jquery")):e.FancyFileInput=i(e.jQuery)}(this,function(s){"use strict";var i=/^.*[\\\/]/,e=/\{0\}/gi,a=function(){for(var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",i[0];);return 4<t?t:document.documentMode}();function l(t,e){var i=s(t).data("FancyFileInput");if(i)return i;e=s.extend({},l.defaults,e),this.el=t,this.$el=s(t),this.$label=this.createLabel(e.buttonText),this._addLabelText(),this.$clearButton=s("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||e.clearButtonText,class:"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||e.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),this.isFocused=!1}return l.defaults={buttonText:"Browseâ€¦",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},l.prototype._addLabelText=function(){var t=s('label[for="'+this.el.id+'"]');t.length&&this.$el.attr("aria-label",t.text())},l.prototype.createLabel=function(t){var e=this.$el.parent(".ffi[data-ffi-button-text]");return e.length||(e=this.$el.wrap(s("<label>",{class:"ffi","data-ffi-button-text":t})).parent()),e},l.prototype.isDisabled=function(){return this.$el.is(":disabled")},l.prototype.formatMultipleFileText=function(t){return this.multipleFileTextPattern.replace(e,t)},l.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,s.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,s.proxy(this.change,this)).on("keydown"+this._eventNamespace,s.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,s.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,s.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,s.proxy(this.focus,this)).on("blur"+this._eventNamespace,s.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,s.proxy(this.clear,this))},l.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},l.prototype.fireEvent=function(t){this.$el.trigger(t+this._eventNamespace)},l.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},l.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},l.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},l.prototype.focus=function(){var t=this;this.$label.addClass(this.CLASSES.focused),a&&!this.isFocused&&(this.isFocused=!0,setTimeout(function(){t.$el.blur(),t.$el.focus()},0))},l.prototype.blur=function(){a&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},l.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},l.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},l.prototype.keydown=function(t){var e=t.which;if(8!==e&&46!==e||(this.clear(),t.preventDefault()),a&&9===e){var i=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout(function(){i.$el.prop("disabled",!1).blur()},0)}},l.prototype.checkValidity=function(){if(this.el.required){var t=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,t).toggleClass(this.CLASSES.valid,!t)}},l.prototype.change=function(){var t,e="";this.checkValidity(),(t=this.el.multiple&&1<this.el.files.length?this.formatMultipleFileText(this.el.files.length):this.el.value).length?(e=t.replace(i,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(e),this.fireEvent("value-changed")},l.prototype.setFieldText=function(t){var e="data-ffi-value";t.length?(this.$label.attr(e,t),this.fireEvent("value-added")):(this.$label.removeAttr(e),this.fireEvent("value-cleared"))},s.fn.fancyFileInput=function(e){return this.each(function(){var t=new l(this,e);s(this).data("FancyFileInput",t)})},l});